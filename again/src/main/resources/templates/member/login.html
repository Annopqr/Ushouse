<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>login</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
<script src="https://kit.fontawesome.com/53a8c415f1.js" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js" integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>
<link rel="stylesheet" type="text/css" href="/css/login.css">

</head>


<body>
    <div class="wrap">
        <form class="login">
            <h2>Log-in</h2>
            
            <div class="login_id">
                <h4>ID</h4>
                <input type="text" id="memberEmail" placeholder="Id">
            </div>
            <div class="login_pw">
                <h4>Password</h4>
                <input type="password" id ="memberPassword" placeholder="Password">
            </div>
            <br><br>
            <div >
                <button class="submit" type="button" onclick = "login()">로그인</button>
            </div>
        </form>
    </div>
<script th:inline="javascript">


const login = () => {
	
	const memberEmail = document.getElementById("memberEmail").value;
	const memberPassword = document.getElementById("memberPassword").value;
	
	new Promise( (succ, fail)=>{
		$.ajax({
			type: "post",
			url: "/member/login",
			
			data: {
				"memberEmail": memberEmail,
				"memberPassword": memberPassword,
				
			},
			success: function(res){
				
				console.log(res);
				localStorage.clear();
				localStorage.setItem('login-token', res.token);
				localStorage.setItem('memberEmail', res.memberEmail);
				localStorage.setItem('roles', res.roles);
				location.href="http://localhost:8081/main";
				
				},
			error: function(err){
				console.log("요청실패",err);
				
			}
		});
		
	});
}
</script>
